@using Warranty.Core.Enumerations
@using Warranty.UI.Core.Helpers
@model Warranty.Core.Features.Report.Achievement.AchievementReportModel

<div class="container">
    <section class="margin-bottom-10">
        <h2 class="pull-left no-margin">WSR Achievement Report</h2>
        @if (Model.AnyResults)
        {
            <div class="warranty-header-buttons">
                <a href="javascript:window.print()" class="btn btn-default pull-right margin-botom-10 no-print"><span class="glyphicon glyphicon-print"></span> Print</a>
            </div>
        }
        <div class="clearfix"></div>
    </section>
    <div class="panel panel-default no-print">
        <div class="panel-heading">
            <div id="wsrLoadingReportFilter">
                <div class="no-bottom-padding">
                    <div class="row">
                        <div class="col-md-12">
                            @using (Html.BeginForm("AchievementReport", "Report", FormMethod.Post, new { @class = "form-inline" }))
                            {

                                <div class="form-group">
                                    @Html.DropDownList("Model.SelectedEmployeeNumber", Model.EmployeeTiedToRepresentatives.Select(c => new SelectListItem { Text = c.EmployeeName, Value = c.EmployeeNumber.ToString() }), "Select Representative", new { @class = "form-control text-capitalize" })
                                </div>
                                <div class="form-group">
                                    @Html.TextBox("Model.StartDate", null, new { @class = "form-control monthpicker-input", placeholder = "Select Start Month" })
                                </div>
                                <div class="form-group">
                                    @Html.TextBox("Model.EndDate", null, new { @class = "form-control monthpicker-input", placeholder = "Select End Month" })
                                </div>
                                <div class="form-group">
                                    <input type="submit" class="btn btn-primary" value="Run Report" />
                                </div>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    @if (!Model.AnyResults)
    {
        <p><em>No entries match report criteria.</em></p>
    }
    else
    {
        <div class="row">
            <div class="col-md-6">
                @Html.Label("Team Member Name: ")
                @Html.DisplayFor(model => model.TeamMemberName)
            </div>           
        </div>
        <br />
            <table class="table table-striped table-bordered">
                <thead>
                    <tr>
                        <th>Period</th>
                        <th class="text-right">Dollars Spent</th>
                        <th class="text-right">Average Days to Closed</th>
                        <th class="text-right">% Within 7 Days</th>
                        <th class="text-right">DWR</th>
                        <th class="text-right">Truly Outstanding Warranty Service</th>
                        <th class="text-right">Right The First Time</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var achievementSummary in Model.MonthlyAchievementSummary)
                {
                        <tr>
                            <td>@Month.FromInt32(achievementSummary.Month) @achievementSummary.Year</td>
                            <td class="text-right">@Format.Money(achievementSummary.AmountSpentPerHome)</td>
                            <td class="text-right">@achievementSummary.AverageDaysClosing</td>
                            <td class="text-right">@Format.Percentage(achievementSummary.PercentComplete7Days)</td>
                            <td class="text-right">@Format.Percentage(achievementSummary.DefinitelyWouldRecommend)</td>
                            <td class="text-right">@Format.Percentage(achievementSummary.OutstandingWarrantyService)</td>
                            <td class="text-right">@Format.Percentage(@achievementSummary.RightTheFirstTime)</td>
                        </tr>
                    }
                    <tr class="totalLine">
                        <td>Average</td>
                        <td class="text-right">@Format.Money(Model.PeriodAchievementSummary.AmountSpentPerHome)</td>
                        <td class="text-right">@Format.WithOneDecimal(Model.PeriodAchievementSummary.AverageDaysClosing)</td>
                        <td class="text-right">@Format.Percentage(Model.PeriodAchievementSummary.PercentComplete7Days)</td>
                        <td class="text-right">@Format.Percentage(Model.PeriodAchievementSummary.DefinitelyWouldRecommend)</td>
                        <td class="text-right">@Format.Percentage(Model.PeriodAchievementSummary.OutstandingWarrantyService)</td>
                        <td class="text-right">@Format.Percentage(@Model.PeriodAchievementSummary.RightTheFirstTime)</td>
                    </tr>
                </tbody>
            </table>
    }
</div>

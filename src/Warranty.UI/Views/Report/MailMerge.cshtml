@model Warranty.Core.Features.Report.MailMerge.MailMergeQuery

@{
    ViewBag.Title = "Mail Merge Report";
}

<div class="container">
    <section class="margin-bottom-10">
        <h2 class="pull-left no-margin">Mail Merge Report</h2>
        @if (Model.AnyResults)
        {
            <div class="warranty-header-buttons">
                @using (Html.BeginForm("MailMergeDownloadAsCsv", "Report"))
                {
                    @(Html.HiddenFor(x => x.Date))
                    <button type="submit" class="btn btn-default pull-right margin-botom-10" value="Download as Csv"><span class="glyphicon glyphicon-download-alt"></span> Download as Csv</button>
                }
            </div>
        }
        <div class="clearfix"></div>
    </section>
    <div class="panel panel-default no-print">
        <div class="panel-heading">
            <div id="warrantyBonusSummaryReportFilter">
                <div class="no-bottom-padding">

                    <div class="row">
                        <div class="col-md-12">

                            @using (Html.BeginForm("MailMerge", "Report", FormMethod.Post, new { @class = "form-inline" }))
                            {
                                <div class="form-group margin-right-10">
                                    <span><strong>Filter by</strong></span>
                                </div>
                                
                                <div class="form-group">
                                    @Html.TextBoxFor(x => x.Date, new { @class = "form-control monthpicker-input", placeholder = "Month", data_val = "false" })
                                </div>
                                <div class="form-group">
                                    <input type="submit" class="btn btn-primary" value="Apply" />
                                </div>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    @if (!Model.AnyResults)
    {
        <p><em>No entries match report criteria.</em></p>
    }
    else
    {
        <table class="table table-striped table-bordered table-bonus">
            <thead>
                <tr>
                    <th>Homeowner Name</th>
                    <th>Address</th>
                    <th>City</th>
                    <th>State</th>
                    <th>Home Phone</th>
                    <th>Community</th>
                    <th>Close Date</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                @foreach (var customer in Model.Result.Customers)
                {
                    <tr>
                        <td>@customer.HomeownerName</td>
                        <td>@customer.AddressLine</td>
                        <td>@customer.City</td>
                        <td>@customer.StateCode</td>
                        <td>@customer.HomePhone</td>
                        <td>@customer.CommunityName</td>
                        <td>@customer.CloseDate</td>
                        <td>@customer.HomeownerName2</td>
                    </tr>
                }
            </tbody>
        </table>

    }
</div>

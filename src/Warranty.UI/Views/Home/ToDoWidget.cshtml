@using Warranty.Core.ToDoInfrastructure.ConcreteTodos
@using Warranty.UI.Core.Helpers
@model Warranty.Core.Features.ToDoWidget.ToDoWidgetModel

<div class="col-md-12">
    <div class="todo-header">
        <span>To Dos</span>
        @Html.DropDownList("SelectecToDoType", Model.ToDoTypes.Select(x => new SelectListItem { Text = x.DisplayName, Value = @Css.ToDoClass(x) }), "All", new { id = "toDoSelect" })
    </div>
    <div class="todo-container">
        @if (Model.ToDos.Any())
        {
            foreach (var toDo in Model.ToDos)
            {
                if (toDo.GetType() == typeof (ToDoEscalationApproval))
                {
                    var castedModel = (ToDoEscalationApproval) toDo;
                    @Html.Partial(castedModel.ViewName, castedModel.Model)
                }
                else if (toDo.GetType() == typeof (ToDoPaymentRequestApproval))
                {
                    var castedModel = (ToDoPaymentRequestApproval) toDo;
                    @Html.Partial(castedModel.ViewName, castedModel.Model)
                }
                else if (toDo.GetType() == typeof (ToDoServiceCallApproval))
                {
                    var castedModel = (ToDoServiceCallApproval) toDo;
                    @Html.Partial(castedModel.ViewName, castedModel.Model)
                }
                else if (toDo.GetType() == typeof (ToDoCommunityEmployeeAssignment))
                {
                    var castedModel = (ToDoCommunityEmployeeAssignment)toDo;
                    @Html.Partial(castedModel.ViewName, castedModel.Model)
                }
            }
            if (Model.ToDos.Count() > 5)
            {
                <div id="ToDo_Display_Size_Controls">
                    <span class="text-muted">Show:</span> 
                    <a href="#" class="show-more-todos">5</a>
                    @if (Model.ToDos.Count() > 5)
                    {
                        <span> | <a href="#" class="show-more-todos">10</a></span>
                    }
                    @if (Model.ToDos.Count() > 10)
                    {
                        <span> | <a href="#" class="show-more-todos">All</a></span>
                    }
                </div>
                <input type="hidden" id="Last_Display_Size" value="5"/>
            }
        }
        else
        {
            <em>No To Dos Today.</em>
        }

    </div>
</div>

